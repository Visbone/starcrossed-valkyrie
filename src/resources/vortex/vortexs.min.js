!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VORTEX=e():t.VORTEX=e()}(global,function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=2)}([function(t,e){t.exports=require("uws")},function(t,e){t.exports=require("msgpack-lite")},function(t,e,s){"use strict";s.r(e);var i=s(0),n=s(1);class r{constructor(t){this.eventName=t,this.callbacks=[]}registerCallback(t){return this.callbacks.push(t)-1}unregisterCallback(t){t>-1&&this.callbacks.splice(t,1)}fire(...t){this.callbacks.slice(0).forEach(e=>{e(...t)})}}class a{constructor(){this.events={}}emit(t,...e){const s=this.events[t];s&&s.fire(...e)}on(t,e){let s=this.events[t];return s||(s=new r(t),this.events[t]=s),s.registerCallback(e)}once(t,e){var s=this.on(t,(...i)=>{e(...i),this.off(t,s)})}off(t,e){const s=this.events[t];s&&e>-1&&(s.unregisterCallback(e),0===s.callbacks.length&&delete this.events[t])}}var o={},h={},c=0;class l{constructor(t,e,s,i){this.parent=s,this.name=t,this.packMapLocation=i,this.isCategory=!0,t in h||(h[t]=c++),this.id=h[t],this.map=e||[],this.data=[this.id,0],this.categories={},this.packMapLocation[this.id]={name:this.name,map:this.map,categories:{}},this.parent.categories[t]=this}Category(t,e){if(t in this.categories)return this.categories[t];if(this.map.length>0)throw Error(`Category ${this.name}: Tried to create subcategory "${t}" to a mapped category.`);var s=new l(t,e,this,this.packMapLocation[this.id].categories);return this.categories[t]=s,s}empty(){this.data.length=2,this.data[1]=0}increment(t){this.data[1]+=t,this.parent.isCategory&&this.parent.increment(t)}push(t){if(0==this.map.length)throw Error(`Category ${this.name}: Tried to push to category without a map.`);for(var e=[],s=0;s<this.map.length;s++)e[s]=t[this.map[s]];e.length>0&&(this.data.push(...e),this.increment(1))}hasCategory(t){return t in this.categories}}class u{constructor(){this.data=[],this.categories={},this.isPack=!0}Category(t,e){if(t in this.categories)return this.categories[t];var s=new l(t,e,this,o);return this.categories[t]=s,s}copy(t){var e=(t,s)=>{for(var i in t.categories){var n,r=t.categories[i];r.map&&(n=JSON.parse(JSON.stringify(r.map)));var a=s.Category(i,n);e(r,a)}};e(t,this)}compile(t){for(var e in t?t.data[1]>0&&this.data.push(...t.data):t=this,t.empty(),t.categories)this.compile(t.categories[e])}empty(){this.data.length=0}}class p extends u{constructor(t,e,s){super(),this.name=t,this.channels=e,this.clients=s,this.isChannel=!0,this.categories={},this.subscribers=[],this.channels[this.name]=this}delete(){this.unsubAll(),delete this.channels[this.name]}sub(t){this.subscribers.push(t),this.clients[t].addChannel(this.name)}unsub(t){var e=this.subscribers.indexOf(t);this.subscribers.splice(e,1),this.clients[t].removeChannel(this.name)}unsubAll(){for(var t of this.subscribers)this.unsub(t)}compileAndPush(){for(var t of(super.compile(),this.subscribers)){this.clients[t].push(this.data)}}}var d=0;class f{constructor(t){this.id=d++,this.ws=t,this.data=[],this.subscriptions=[]}push(t){"Pack"==t.constructor.name?this.data.push(...t.data):t instanceof Array?this.data.push(...t):this.data.push(t)}empty(){this.data.length=0}addChannel(t){this.subscriptions.push(t)}removeChannel(t){this.subscriptions.indexOf(t);this.subscriptions.splice(t,1)}}class g extends a{constructor(t,e){super(),t.perMessageDeflate=!1,this.wss=new i.Server(t),this.RATE=e,this.isServer=!0,this.clients={},this.channels={},this.wss.on("connection",t=>{var e=new f(t),s=e.id;this.clients[s]=e,e.push(o),this.emit("connect",e),t.on("pong",function(){t.isAlive=!0}),t.isAlive=!0,t.on("close",()=>{for(var t=e.subscriptions.length;t-- >0;)this.channels[e.subscriptions[t]].unsub(s);delete this.clients[s],this.emit("close",s)}),t.on("message",t=>{this.emit("message",e,t)})})}Client(t){return t in this.clients&&this.clients[t]}Channel(t){return t in this.channels?this.channels[t]:new p(t,this.channels,this.clients)}pingLoop(){for(var t in this.clients){var e=this.clients[t].ws;if(!e.isAlive)return e.terminate();e.isAlive=!1,e.ping()}}serverLoop(){for(var t in this.emit("sendToAllClients"),this.channels){this.channels[t].compileAndPush()}for(var e in this.clients){var s=this.clients[e];this.emit("sendToClient",s),this.send(e,s.data),s.empty()}}send(t,e){var s=this.clients[t].ws;s&&s.readyState===i.OPEN&&("Pack"==e.constructor.name?s.send(n.encode(e.data)):s.send(n.encode(e)))}run(t){this.serverInterval=setInterval(()=>{this.serverLoop()},1e3/this.RATE),this.pingInterval=setInterval(this.pingLoop,5e3),t&&t()}pause(t){clearInterval(this.serverInterval),clearInterval(this.pingInterval),t&&t()}stop(t){this.pause(),this.cli]]}return t}};s.d(e,"Server",function(){return g}),s.d(e,"Toolkit",function(){return v}),s.d(e,"Pack",function(){return u})}])});entID=0,this.packCList.length=0,this.packCounter=1,t&&t()}sendToAllClients(){}sendToClient(t){}onConnect(t){}onClose(t){}onMessage(t,e){}close(t){t in this.clients&&this.clients[t].ws.terminate()}}var v={Get:function(t,e){t||(t={});for(var s=e.split("."),i=0;i<s.length;i+=1){if(!(s[i]in t))return;t=t[s[i